DimCurrency:
  create: |
    CREATE TABLE DimCurrency (
      CurrencyKey INT PRIMARY KEY,
      CurrencyAlternateKey NCHAR(3),
      CurrencyName NVARCHAR(50)
    );

DimSalesTerritory:
  create: |
    CREATE TABLE DimSalesTerritory (
      SalesTerritoryKey INT  PRIMARY KEY,
      SalesTerritoryAlternateKey INT,
      SalesTerritoryRegion NVARCHAR(50),
      SalesTerritoryCountry NVARCHAR(50),
      SalesTerritoryGroup NVARCHAR(50)
    );

DimGeography:
  create: |
    CREATE TABLE DimGeography (
      GeographyKey INT  PRIMARY KEY,
      City NVARCHAR(30),
      StateProvinceCode NCHAR(3),
      StateProvinceName NVARCHAR(50),
      CountryRegionCode NVARCHAR(3),
      EnglishCountryRegionName NVARCHAR(50),
      SpanishCountryRegionName NVARCHAR(50),
      FrenchCountryRegionName NVARCHAR(50),
      PostalCode NVARCHAR(15),
      SalesTerritoryKey INT,
      IpAddressLocator NVARCHAR(15),
      FOREIGN KEY (SalesTerritoryKey) REFERENCES DimSalesTerritory(SalesTerritoryKey)
    );

DimCustomer:
  create: |
    CREATE TABLE DimCustomer (
      CustomerKey INT  PRIMARY KEY,
      GeographyKey INT,
      CustomerAlternateKey NVARCHAR(15),
      Title NVARCHAR(8),
      FirstName NVARCHAR(50),
      MiddleName NVARCHAR(50),
      LastName NVARCHAR(50),
      NameStyle BIT,
      BirthDate DATE,
      MaritalStatus NCHAR(1),
      Suffix NVARCHAR(10),
      Gender NVARCHAR(1),
      EmailAddress NVARCHAR(50),
      YearlyIncome VARCHAR(30),
      TotalChildren INT,
      NumberChildrenAtHome INT,
      EnglishEducation NVARCHAR(40),
      SpanishEducation NVARCHAR(40),
      FrenchEducation NVARCHAR(40),
      EnglishOccupation NVARCHAR(100),
      SpanishOccupation NVARCHAR(100),
      FrenchOccupation NVARCHAR(100),
      HouseOwnerFlag NCHAR(1),
      NumberCarsOwned INT,
      AddressLine1 NVARCHAR(120),
      AddressLine2 NVARCHAR(120),
      Phone NVARCHAR(20),
      DateFirstPurchase DATE,
      CommuteDistance NVARCHAR(15),
      FOREIGN KEY (GeographyKey) REFERENCES DimGeography(GeographyKey)
    );

DimDate:
  create: |
    CREATE TABLE DimDate (
      DateKey INT PRIMARY KEY,
      FullDateAlternateKey DATE NOT NULL,
      DayNumberOfWeek TINYINT,
      EnglishDayNameOfWeek NVARCHAR(10),
      SpanishDayNameOfWeek NVARCHAR(10),
      FrenchDayNameOfWeek NVARCHAR(10),
      DayNumberOfMonth TINYINT,
      DayNumberOfYear SMALLINT,
      WeekNumberOfYear TINYINT,
      EnglishMonthName NVARCHAR(10),
      SpanishMonthName NVARCHAR(10),
      FrenchMonthName NVARCHAR(10),
      MonthNumberOfYear TINYINT,
      CalendarQuarter TINYINT,
      CalendarYear SMALLINT,
      CalendarSemester TINYINT,
      FiscalQuarter TINYINT,
      FiscalYear SMALLINT,
      FiscalSemester TINYINT
    );

DimEmployee:
  create: |
    CREATE TABLE DimEmployee (
      EmployeeKey INT  PRIMARY KEY,
      ParentEmployeeKey INT,
      EmployeeNationalIDAlternateKey NVARCHAR(15),
      ParentEmployeeNationalIDAlternateKey NVARCHAR(15),
      SalesTerritoryKey INT,
      FirstName NVARCHAR(50),
      LastName NVARCHAR(50),
      MiddleName NVARCHAR(50),
      NameStyle NCHAR(1),
      Title NVARCHAR(50),
      HireDate DATE,
      BirthDate DATE,
      LoginID NVARCHAR(256),
      EmailAddress NVARCHAR(50),
      Phone NVARCHAR(25),
      MaritalStatus NCHAR(1),
      SalariedFlag NCHAR(1),
      Gender NCHAR(1),
      PayFrequency TINYINT,
      BaseRate MONEY,
      VacationHours SMALLINT,
      SickLeaveHours SMALLINT,
      CurrentFlag NCHAR(1),
      SalesPersonFlag NCHAR(1),
      DepartmentName NVARCHAR(50),
      StartDate DATE,
      EndDate DATE,
      Status NVARCHAR(25),
      FOREIGN KEY (SalesTerritoryKey) REFERENCES DimSalesTerritory(SalesTerritoryKey),
      FOREIGN KEY (ParentEmployeeKey) REFERENCES DimEmployee(EmployeeKey)
    );

DimProductCategory:
  create: |
    CREATE TABLE DimProductCategory (
      ProductCategoryKey INT  PRIMARY KEY,
      ProductCategoryAlternateKey INT,
      EnglishProductCategoryName NVARCHAR(50),
      SpanishProductCategoryName NVARCHAR(50),
      FrenchProductCategoryName NVARCHAR(50)
    );

DimProductSubcategory:
  create: |
    CREATE TABLE DimProductSubcategory (
      ProductSubcategoryKey INT  PRIMARY KEY,
      ProductSubcategoryAlternateKey INT,
      EnglishProductSubcategoryName NVARCHAR(50),
      SpanishProductSubcategoryName NVARCHAR(50),
      FrenchProductSubcategoryName NVARCHAR(50),
      ProductCategoryKey INT,
      FOREIGN KEY (ProductCategoryKey) REFERENCES DimProductCategory(ProductCategoryKey)
    );
DimProduct:
  create: |
    CREATE TABLE DimProduct (
      ProductKey INT  PRIMARY KEY,
      ProductAlternateKey NVARCHAR(25),
      ProductSubcategoryKey INT,
      WeightUnitMeasureCode NCHAR(3),
      SizeUnitMeasureCode NCHAR(3),
      EnglishProductName NVARCHAR(50),
      SpanishProductName NVARCHAR(50),
      FrenchProductName NVARCHAR(50),
      StandardCost MONEY,
      FinishedGoodsFlag BIT,
      Color NVARCHAR(15),
      SafetyStockLevel SMALLINT,
      ReorderPoint SMALLINT,
      ListPrice MONEY,
      Size NVARCHAR(50),
      SizeRange NVARCHAR(50),
      Weight FLOAT,
      DaysToManufacture INT,
      ProductLine NCHAR(2),
      DealerPrice MONEY,
      Class NCHAR(2),
      Style NCHAR(2),
      ModelName NVARCHAR(50),
      EnglishDescription NVARCHAR(400),
      FrenchDescription NVARCHAR(400),
      ChineseDescription NVARCHAR(400),
      ArabicDescription NVARCHAR(400),
      HebrewDescription NVARCHAR(400),
      ThaiDescription NVARCHAR(400),
      GermanDescription NVARCHAR(400),
      JapaneseDescription NVARCHAR(400),
      TurkishDescription NVARCHAR(400),
      StartDate DATETIME,
      EndDate DATETIME,
      Status NVARCHAR(7),
      FOREIGN KEY (ProductSubcategoryKey) REFERENCES DimProductSubcategory(ProductSubcategoryKey)
    );

DimPromotion:
  create: |
    CREATE TABLE DimPromotion (
      PromotionKey INT  PRIMARY KEY,
      PromotionAlternateKey INT,
      EnglishPromotionName NVARCHAR(255),
      SpanishPromotionName NVARCHAR(255),
      FrenchPromotionName NVARCHAR(255),
      DiscountPct FLOAT,
      EnglishPromotionType NVARCHAR(50),
      SpanishPromotionType NVARCHAR(50),
      FrenchPromotionType NVARCHAR(50),
      EnglishPromotionCategory NVARCHAR(50),
      SpanishPromotionCategory NVARCHAR(50),
      FrenchPromotionCategory NVARCHAR(50),
      StartDate DATETIME,
      EndDate DATETIME,
      MinQty INT,
      MaxQty INT
    );

DimReseller:
  create: |
    CREATE TABLE DimReseller (
      ResellerKey INT  PRIMARY KEY,
      GeographyKey INT,
      ResellerAlternateKey NVARCHAR(15),
      Phone NVARCHAR(25),
      BusinessType NVARCHAR(20),
      ResellerName NVARCHAR(50),
      NumberEmployees INT,
      OrderFrequency CHAR(1),
      OrderMonth TINYINT,
      FirstOrderYear INT,
      LastOrderYear INT,
      ProductLine NVARCHAR(50),
      AddressLine1 NVARCHAR(60),
      AddressLine2 NVARCHAR(60),
      AnnualSales MONEY,
      BankName NVARCHAR(50),
      AnnualRevenue MONEY,
      YearOpened INT,
      FOREIGN KEY (GeographyKey) REFERENCES DimGeography(GeographyKey)
    );

DimSalesReason:
  create: |
    CREATE TABLE DimSalesReason (
      SalesReasonKey INT  PRIMARY KEY,
      SalesReasonAlternateKey INT,
      SalesReasonName NVARCHAR(50),
      SalesReasonType NVARCHAR(50)
    );

FactCurrencyRate:
  create: |
    CREATE TABLE FactCurrencyRate (
      Date DATETIME,
      AverageRate FLOAT NOT NULL,
      EndOfDayRate FLOAT NOT NULL,
      DateKey INT NOT NULL,
      CurrencyKey INT NOT NULL,
      CONSTRAINT PK_FactCurrencyRate PRIMARY KEY (CurrencyKey, DateKey),
      FOREIGN KEY (DateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (CurrencyKey) REFERENCES DimCurrency(CurrencyKey)
    );

FactInternetSales:
  create: |
    CREATE TABLE FactInternetSales (
      ProductKey INT NOT NULL,
      OrderDateKey INT NOT NULL,
      DueDateKey INT NOT NULL,
      ShipDateKey INT NOT NULL,
      CustomerKey INT NOT NULL,
      PromotionKey INT NOT NULL,
      CurrencyKey INT NOT NULL,
      SalesTerritoryKey INT NOT NULL,
      SalesOrderNumber NVARCHAR(20) NOT NULL,
      SalesOrderLineNumber TINYINT NOT NULL,
      RevisionNumber TINYINT NOT NULL,
      OrderQuantity SMALLINT NOT NULL,
      UnitPrice MONEY NOT NULL,
      ExtendedAmount MONEY NOT NULL,
      UnitPriceDiscountPct FLOAT NOT NULL,
      DiscountAmount FLOAT NOT NULL,
      ProductStandardCost MONEY NOT NULL,
      TotalProductCost MONEY NOT NULL,
      SalesAmount MONEY NOT NULL,
      TaxAmt MONEY NOT NULL,
      Freight MONEY NOT NULL,
      CarrierTrackingNumber NVARCHAR(25),
      CustomerPONumber NVARCHAR(25),
      OrderDate DATETIME,
      DueDate DATETIME,
      ShipDate DATETIME,

      PRIMARY KEY (SalesOrderNumber, SalesOrderLineNumber),

      FOREIGN KEY (ProductKey) REFERENCES DimProduct(ProductKey),
      FOREIGN KEY (OrderDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (DueDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (ShipDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (CustomerKey) REFERENCES DimCustomer(CustomerKey),
      FOREIGN KEY (PromotionKey) REFERENCES DimPromotion(PromotionKey),
      FOREIGN KEY (CurrencyKey) REFERENCES DimCurrency(CurrencyKey),
      FOREIGN KEY (SalesTerritoryKey) REFERENCES DimSalesTerritory(SalesTerritoryKey)
    );

FactInternetSalesReason:
  create: |
    CREATE TABLE FactInternetSalesReason (
      SalesOrderNumber NVARCHAR(20) NOT NULL,
      SalesOrderLineNumber TINYINT NOT NULL,
      SalesReasonKey INT NOT NULL,

      PRIMARY KEY (SalesOrderNumber, SalesOrderLineNumber, SalesReasonKey),

      FOREIGN KEY (SalesOrderNumber, SalesOrderLineNumber)
        REFERENCES FactInternetSales(SalesOrderNumber, SalesOrderLineNumber),

      --FOREIGN KEY (SalesReasonKey)
        REFERENCES DimSalesReason(SalesReasonKey)
    );

FactResellerSales:
  create: |
    CREATE TABLE FactResellerSales (
      ProductKey INT NOT NULL,
      OrderDateKey INT NOT NULL,
      DueDateKey INT NOT NULL,
      ShipDateKey INT NOT NULL,
      ResellerKey INT NOT NULL,
      EmployeeKey INT NOT NULL,
      PromotionKey INT NOT NULL,
      CurrencyKey INT NOT NULL,
      SalesTerritoryKey INT NOT NULL,
      SalesOrderNumber NVARCHAR(20) NOT NULL,
      SalesOrderLineNumber INT NOT NULL,
      RevisionNumber TINYINT NOT NULL,
      OrderQuantity SMALLINT NOT NULL,
      UnitPrice MONEY NOT NULL,
      ExtendedAmount MONEY NOT NULL,
      UnitPriceDiscountPct FLOAT NOT NULL,
      DiscountAmount FLOAT NOT NULL,
      ProductStandardCost MONEY NOT NULL,
      TotalProductCost MONEY NOT NULL,
      SalesAmount MONEY NOT NULL,
      TaxAmt MONEY NOT NULL,
      Freight MONEY NOT NULL,
      CarrierTrackingNumber NVARCHAR(25),
      CustomerPONumber NVARCHAR(25),
      OrderDate DATETIME,
      DueDate DATETIME,
      ShipDate DATETIME,

      PRIMARY KEY (SalesOrderNumber, SalesOrderLineNumber),

      FOREIGN KEY (ProductKey) REFERENCES DimProduct(ProductKey),
      FOREIGN KEY (OrderDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (DueDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (ShipDateKey) REFERENCES DimDate(DateKey),
      FOREIGN KEY (ResellerKey) REFERENCES DimReseller(ResellerKey),
      FOREIGN KEY (EmployeeKey) REFERENCES DimEmployee(EmployeeKey),
      FOREIGN KEY (PromotionKey) REFERENCES DimPromotion(PromotionKey),
      FOREIGN KEY (CurrencyKey) REFERENCES DimCurrency(CurrencyKey),
      FOREIGN KEY (SalesTerritoryKey) REFERENCES DimSalesTerritory(SalesTerritoryKey)
    );

NewFactCurrencyRate:
  create: |
    CREATE TABLE NewFactCurrencyRate (
      AverageRate FLOAT NOT NULL,
      CurrencyID NVARCHAR(3) NOT NULL,
      CurrencyDate DATE NOT NULL,
      EndOfDayRate FLOAT NOT NULL,
      CurrencyKey INT NOT NULL,
      DateKey INT NOT NULL,
      CONSTRAINT PK_NewFactCurrencyRate PRIMARY KEY (CurrencyKey, DateKey),
      FOREIGN KEY (CurrencyKey) REFERENCES DimCurrency(CurrencyKey),
      FOREIGN KEY (DateKey) REFERENCES DimDate(DateKey)
    );
